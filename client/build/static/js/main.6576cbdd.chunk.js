(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{157:function(e,t,a){e.exports=a(439)},161:function(e,t,a){},439:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(15),o=a.n(r),i=(a(161),a(89)),l=a.n(i),c=a(145),m=a(156),u=a(6),d=a(7),h=a(5),p=a(10),v=a(9),b=Object(n.createContext)(null),g=a(36);function E(){return s.a.createElement("div",{className:"navbar-nav "},s.a.createElement(g.b,{to:"/",style:{textDecoration:"none",color:"unset"}},s.a.createElement("a",{className:"nav-link nav-item",href:"#"},"Sell")),s.a.createElement("a",{className:"nav-link nav-item",href:"signin"},"Sign in"),s.a.createElement("a",{className:"nav-link nav-item",href:"signup"},"Sign Up"))}var f=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).LogOut=n.LogOut.bind(Object(h.a)(n)),n}return Object(d.a)(a,[{key:"LogOut",value:function(){localStorage.removeItem("auth-token"),this.context.setUserData({token:void 0,user:void 0})}},{key:"render",value:function(){return s.a.createElement("div",{className:"navbar-nav "},s.a.createElement("a",{className:"nav-link nav-item",href:"sell"},"Sell"),s.a.createElement("a",{className:"nav-link nav-item",href:"#",onClick:this.LogOut},"logout"))}}]),a}(s.a.Component);f.contextType=b;var N=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).setState({login:!1}),n}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark "},s.a.createElement("a",{className:"navbar-brand",href:"\\"},"AuctionZone"),void 0==this.context.userData.token?s.a.createElement(E,null):s.a.createElement(f,null))}}]),a}(s.a.Component);N.contextType=b;var C=N,y=a(8),k=a.n(y),j=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={img:""},k.a.get("/api/item/"+n.props.uid).then((function(e){n.setState({img:e.data.image})})),n}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"carousel slide","data-ride":"carousel"},s.a.createElement("div",{className:"carousel-inner img-thumbnail"},s.a.createElement("div",{className:"carousel-item active "},s.a.createElement("img",{src:this.state.img,className:"d-block w-100",alt:"..."}))))}}]),a}(s.a.Component),O=a(442),w=a(443),S=a(37),x=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).closeItem=function(e){k.a.post("/api/bid/close",{id:n.props.uid},{headers:{"x-auth-token":n.context.userData.token}}).then((function(e){})).catch((function(e){400==e.response.status&&n.setState({msg:"Cannot close bid"})}))},n.state={data:{},bidmodal:!1,logged:!0,spinner:!0},k.a.get("/api/item/"+n.props.uid).then((function(e){n.setState({data:e.data,spinner:!1})})),n.closeModal=n.closeModal.bind(Object(h.a)(n)),n.placeBid=n.placeBid.bind(Object(h.a)(n)),n}return Object(d.a)(a,[{key:"closeModal",value:function(){this.setState({bidmodal:!1})}},{key:"placeBid",value:function(){void 0===this.context.userData.user&&this.setState({logged:!1}),this.setState({bidmodal:!0})}},{key:"render",value:function(){return console.log(this.context.userData,(new Date).getTime()),this.state.spinner?s.a.createElement("div",{className:"card mt-5"},s.a.createElement("div",{className:"card-body"},s.a.createElement("div",{className:"spinner-border",role:"status"}))):s.a.createElement("div",{className:"card mt-5"},s.a.createElement("div",{className:"card-body"},s.a.createElement("p",{className:"card-title display-4"},this.state.data.name),s.a.createElement("hr",{className:"my-4"}),s.a.createElement("div",{className:"ml-3"},s.a.createElement("h2",{className:"card-text"}," Sold by ",this.state.data.seller),s.a.createElement("h3",{className:"card-text "},this.state.data.condition),s.a.createElement("div",{className:"py-3"},s.a.createElement("h4",{className:"card-text"}," Starting Price ",s.a.createElement("span",{style:{color:"darkblue"}},"$",this.state.data.cost)," ")),this.state.data.bidOpen?null!=this.context.userData.user&&this.context.userData.user._id===this.state.data.sellerId?s.a.createElement("button",{className:"btn btn-danger",onClick:this.closeItem},"Close Bid"):s.a.createElement("button",{className:"btn  btn-primary",onClick:this.placeBid},"Place Bid"):s.a.createElement("p",{className:"alert alert-danger"},"Bidding closed"),this.state.bidmodal?s.a.createElement(B,{closeModal:this.closeModal,data:this.state.data}):null,this.state.logged?null:s.a.createElement(S.a,{to:"/signin"}))))}}]),a}(n.Component);x.contextType=b;var B=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={show:!0,amount:Math.max(n.props.data.latestBid,n.props.data.cost)+1,latestBid:Math.max(n.props.data.latestBid,n.props.data.cost),showError:!1,error:""},n.handleClose=n.handleClose.bind(Object(h.a)(n)),n.changeAmount=n.changeAmount.bind(Object(h.a)(n)),n}return Object(d.a)(a,[{key:"handleClose",value:function(){var e=this;if(this.state.amount<=this.state.latestBid)this.setState({error:"Bid must be greater than latest bid "+this.state.latestBid,showError:!0});else{var t={productId:this.props.data._id,user:this.context.userData.user.username,cost:this.state.amount};k.a.post("/api/bid/add",t,{headers:{"x-auth-token":this.context.userData.token}}).then((function(t){e.props.closeModal()})).catch((function(t){400==t.response.status&&(e.setState({latestBid:t.response.data.lastBid}),e.setState({error:"Bid must be greater than latest bid "+e.state.latestBid,showError:!0}))}))}}},{key:"changeAmount",value:function(e){this.setState({amount:e.target.value}),this.setState({showError:!1})}},{key:"render",value:function(){return s.a.createElement(O.a,{show:this.state.show,onHide:this.props.closeModal},s.a.createElement(O.a.Header,{closeButton:!0},s.a.createElement(O.a.Title,null,"Placing Bid")),s.a.createElement(O.a.Body,null,"Place bid for",s.a.createElement("input",{type:"number",value:this.state.amount,className:"form-control",onChange:this.changeAmount}),this.state.showError?s.a.createElement("div",{className:"alert alert-danger my-3",role:"alert"},this.state.error):null),s.a.createElement(O.a.Footer,null,s.a.createElement(w.a,{variant:"secondary",onClick:this.props.closeModal},"Cancel"),s.a.createElement(w.a,{variant:"primary",onClick:this.handleClose},"Place Bid")))}}]),a}(n.Component);B.contextType=b;var D=x,I=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={data:{}},k.a.get("/api/item/"+n.props.uid).then((function(e){})),n}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"col-10"},s.a.createElement("div",{className:"card mt-5",style:{backgroundColor:"#d1ecf1"}},s.a.createElement("div",{className:"card-body px-2 py-3"},s.a.createElement("h5",{className:"card-text"},this.props.user," has placed Bid at $",this.props.cost))))}}]),a}(n.Component),U=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).props.location.state?(n.state={uid:n.props.location.state.id},k.a.get("/api/bid/"+n.state.uid).then((function(e){n.setState({bids:e.data})}))):n.state={redirect:!0},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.state.redirect?s.a.createElement(S.a,{to:"/"}):s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row item-row mx-lg-5"},s.a.createElement("div",{className:"col col-lg-6 col-12 csl-cont"},s.a.createElement(j,{uid:this.state.uid})),s.a.createElement("div",{className:"col col-sm-12 col-lg-6"},s.a.createElement(D,{uid:this.state.uid}))),s.a.createElement("div",{className:"row justify-content-center"},this.state.bids?this.state.bids.map((function(e,t){return s.a.createElement(I,{cost:e.cost,user:e.user,key:e._id})})):s.a.createElement("div",{class:"display-4 text-muted mt-4"},"No Bids have been placed")))}}]),a}(n.Component);var P=function(e){return s.a.createElement(g.b,{to:{pathname:"item",state:{id:e.uid}},style:{textDecoration:"none",color:"unset"}},"      ",s.a.createElement("div",{className:"card icard"},s.a.createElement("img",{src:e.img,className:"card-img-top",alt:"..."}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title"},e.name),s.a.createElement("h5",{className:"card-title float-right "},"Starting from $",e.cost),s.a.createElement("div",{className:"card-subtitle "},e.cond))))},M=(a(183),function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={items:[]},k.a.get("/api/item/").then((function(e){n.setState({items:e.data})})),n}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col col-8 basecard"},this.state.items.map((function(e,t){return s.a.createElement(P,{key:t,uid:e._id,name:e.name,cond:e.condition,cost:e.cost,img:e.image})}))))}}]),a}(n.Component)),T=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).matching=n.matching.bind(Object(h.a)(n)),n.onUsernameChange=n.onUsernameChange.bind(Object(h.a)(n)),n.passwordChange=n.passwordChange.bind(Object(h.a)(n)),n.cpasswordChange=n.cpasswordChange.bind(Object(h.a)(n)),n.onSubmit=n.onSubmit.bind(Object(h.a)(n)),n.mobileChange=n.mobileChange.bind(Object(h.a)(n)),n.mailChange=n.mailChange.bind(Object(h.a)(n)),n.state={username:"",password:"",cpassword:"",match:!0,mobile:"",mail:"",valid:""},n}return Object(d.a)(a,[{key:"mailChange",value:function(e){this.setState({mail:e.target.value},(function(){}),(function(){}))}},{key:"mobileChange",value:function(e){this.setState({mobile:e.target.value})}},{key:"matching",value:function(){this.state.password!=this.state.cpassword?this.setState({match:!1}):this.setState({match:!0})}},{key:"passwordChange",value:function(e){this.setState({password:e.target.value},this.matching)}},{key:"cpasswordChange",value:function(e){this.setState({cpassword:e.target.value},this.matching)}},{key:"onUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"onSubmit",value:function(e){var t=this,a=!0;/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(this.state.mail).toLowerCase())||(console.log("f"),a=!1),0==this.state.username.length&&(console.log("a"),a=!1),this.state.match&&0!=this.state.password.length||(console.log("g"),a=!1),10!=this.state.mobile.length&&(console.log("n"),a=!1),a?(console.log(this.state.username+this.state.password),k.a.post("/api/user/register",{username:this.state.username,password:this.state.password,mobile:this.state.mobile,mail:this.state.mail}).then((function(e){200==e.status&&console.log("registration success"),t.setState({username:"",password:"",cpassword:"",mobile:"",mail:"",valid:""})})).catch((function(e){t.setState({valid:e.response.data.error})}))):alert("fill out the fields")}},{key:"render",value:function(){return s.a.createElement("div",{className:"row  d-flex justify-content-center"},s.a.createElement("div",{className:"col col-4  mt-5"},s.a.createElement("h1",{className:"display-4"},"Sell your stuff"),s.a.createElement("h2",null,"Register Here"),s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{className:"r-input",name:"uname",id:"uname",onChange:this.onUsernameChange,value:this.state.username,placeholder:"Username"}),s.a.createElement("p",null,this.state.valid)),s.a.createElement("div",{className:"input-group mt-2"},s.a.createElement("input",{name:"Mobile",className:"r-input",value:this.state.mobile,type:"text",placeholder:"Mobile",onChange:this.mobileChange})),s.a.createElement("div",{className:"input-group mt-2"},s.a.createElement("input",{name:"Email",className:"r-input",value:this.state.mail,type:"email",placeholder:"Email",onChange:this.mailChange})),s.a.createElement("div",{className:"input-group mt-2"},s.a.createElement("input",{name:"pass",className:"r-input",value:this.state.password,type:"password",placeholder:"password",onChange:this.passwordChange})),s.a.createElement("div",{className:"input-group mt-2"},s.a.createElement("input",{name:"cpass",className:"r-input",value:this.state.cpassword,type:"password",placeholder:"Confirm password",onChange:this.cpasswordChange})),s.a.createElement("button",{className:"btn btn-md btn-danger mt-4",onClick:this.onSubmit},"Sign Up")))}}]),a}(n.Component),A=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).onUsernameChange=n.onUsernameChange.bind(Object(h.a)(n)),n.onPassChange=n.onPassChange.bind(Object(h.a)(n)),n.onSubmit=n.onSubmit.bind(Object(h.a)(n)),n.state={username:"",password:""},n}return Object(d.a)(a,[{key:"onUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"onPassChange",value:function(e){this.setState({password:e.target.value})}},{key:"onSubmit",value:function(e){var t=this;k.a.post("/api/user/login",{username:this.state.username,password:this.state.password}).then((function(e){200==e.status&&(console.log(e.data),localStorage.setItem("auth-token",e.data.token),t.context.setUserData({token:e.data.token,user:e.data}),t.props.history.push("/"))})),console.log(this.state.username),this.setState({username:"",password:""})}},{key:"render",value:function(){return s.a.createElement("div",{className:"row  d-flex justify-content-center"},s.a.createElement("div",{className:"col col-4  mt-5"},s.a.createElement("h1",{className:"display-4"},"Sell your stuff"),s.a.createElement("h2",null,"Sign In"),s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{name:"uname",className:"r-input",id:"uname",onChange:this.onUsernameChange,value:this.state.username,placeholder:"Username"})),s.a.createElement("div",{className:"input-group mt-2"},s.a.createElement("input",{name:"pass",type:"password",className:"r-input",placeholder:"password",onChange:this.onPassChange})),s.a.createElement("button",{className:"btn btn-md btn-danger mt-4",onClick:this.onSubmit},"Sign in")))}}]),a}(n.Component);A.contextType=b;var L=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={name:"",cost:"",condition:"",seller:"",uploaded:0,showProgress:!1},n.handleItem=n.handleItem.bind(Object(h.a)(n)),n.onNameChange=n.onNameChange.bind(Object(h.a)(n)),n.onCostChange=n.onCostChange.bind(Object(h.a)(n)),n.onConditionChange=n.onConditionChange.bind(Object(h.a)(n)),n}return Object(d.a)(a,[{key:"onNameChange",value:function(e){this.setState({name:e.target.value,seller:this.context.userData.user.username})}},{key:"onCostChange",value:function(e){this.setState({cost:e.target.value})}},{key:"onConditionChange",value:function(e){this.setState({condition:e.target.value})}},{key:"handleItem",value:function(e){var t=this;e.preventDefault();var a=new FormData;a.append("name",this.state.name),a.append("condition",this.state.condition),a.append("cost",this.state.cost),a.append("seller",this.state.seller),a.append("file",this.uploadInput.files[0]),a.append("filename","prodimage1"),this.setState({showProgress:!0}),k.a.post("/api/item/new",a,{headers:{"x-auth-token":this.context.userData.token},onUploadProgress:function(e){t.setState({uploaded:parseInt(Math.round(100*e.loaded/e.total))}),e.loaded==e.total&&t.setState({uploaded:0,showProgress:!1})}}).then((function(e){console.log("success")}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.handleItem},s.a.createElement("div",{className:"input-group mt-4"},s.a.createElement("input",{className:"r-input",name:"name",placeholder:"Name",value:this.state.name,onChange:this.onNameChange})),s.a.createElement("div",{className:"input-group mt-4"},s.a.createElement("input",{className:"r-input",name:"cost",placeholder:"Cost",value:this.state.cost,onChange:this.onCostChange})),s.a.createElement("div",{className:"input-group mt-4"},s.a.createElement("input",{className:"r-input",name:"condition",placeholder:"condition",value:this.state.condition,onChange:this.onConditionChange})),s.a.createElement("div",{className:"input-group mt-4"},s.a.createElement("input",{ref:function(t){e.uploadInput=t},type:"file"})),this.state.showProgress&&s.a.createElement(_,{uploaded:this.state.uploaded}),s.a.createElement("button",{className:"btn btn-primary mt-5"},"Submit")))}}]),a}(s.a.Component);L.contextType=b;var $=function(e){return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row justify-content-around align-items-center"},s.a.createElement("div",{className:"col-md-6 "},s.a.createElement("div",{className:"jumbotron"},s.a.createElement("div",{className:"container"},s.a.createElement("h1",{className:"display-4"},"Get a good price for your items"),s.a.createElement("p",{class:"lead"},"Fill the Details to sell your item")))),s.a.createElement("div",{class:"col-md-6"},s.a.createElement(L,null))))},_=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(d.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"progress"},s.a.createElement("div",{className:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":this.props.uploaded,"aria-valuemin":"0","aria-valuemax":"100",style:{width:"".concat(this.props.uploaded,"%")}}))}}]),a}(s.a.Component);var F=function(){var e=Object(n.useState)({token:void 0,user:void 0}),t=Object(m.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){console.log("refreshed"),function(){var e=Object(c.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("auth-token"),r({token:t}),null===t&&(localStorage.setItem("auth-token",""),t=""),e.next=5,k.a.post("/api/user/isTokenValid",null,{headers:{"x-auth-token":t}});case 5:if(!e.sent.data){e.next=14;break}return e.next=9,k.a.get("/api/user/userData",{headers:{"x-auth-token":t}});case 9:a=e.sent,console.log((new Date).getTime()),r({token:t,user:a.data}),e.next=15;break;case 14:r({token:void 0,user:void 0});case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),s.a.createElement(g.a,null,s.a.createElement(b.Provider,{value:{userData:a,setUserData:r}},s.a.createElement(C,null),s.a.createElement(S.d,null,s.a.createElement(S.b,{path:"/sell"},s.a.createElement($,null)," "),s.a.createElement(S.b,{path:"/signin",component:A}),s.a.createElement(S.b,{path:"/signup"},s.a.createElement(T,null)),s.a.createElement(S.b,{path:"/item/",component:U}),s.a.createElement(S.b,{path:"/"},s.a.createElement(M,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[157,1,2]]]);
//# sourceMappingURL=main.6576cbdd.chunk.js.map